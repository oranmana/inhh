insert into hctinh.dirs
select
  dir_id as id,
  0 as 'type',
  dir_cat as sex,
  dir_par as par,
  dir_code as code,
  dir_cm as grp,
  dir_num as num,
  dir_nm as nm,
  dir_name as name,
  dir_tname as tname,
  dir_cmcty as nation,
  dir_addr as address,
  dir_tel as tel,
  dir_fax as fax,
  dir_mail as email,
  dir_rdate as bdate,
  if(dir_type=1, dir_app, null) as xdate,
  dir_cap as cap,
  dir_md as md,
  if(dir_type>0, 0, dir_vd) as appby,
  if(dir_type>0, null, dir_app) as appdate,
  sup_valid as validity,
  if(length(dir_fi)+length(dir_mm)+length(dir_sd),1,0) as iserp,
  dir_main as erpdir,
  dir_fi as erpfi,
  dir_mm as erpmm,
  dir_sd as erpsd,
  0 as empid,
  0 as emprelative,
  0 as empcat,
  dir_memo as rem,
  dir_status as state,
  dir_eby as eby,
  dir_ebyd as eon,
  zdir_id as zdir,
  dir_pic as pic,
  dir_reg as reg,
  dir_tax as tax,
  dir_cty as cty,
  dir_eby as CREATED_BY,
  dir_ebyd as CREATED_AT,
  dir_eby as UPDATED_BY,
  dir_ebyd as UPDATED_AT
from hctdb.tbdir
  left join hctinh.mkbooking on dir_id = agentid
where agentid > 0 and agentid not in (1848,1852)
group by 1;
